(this.webpackJsonpSpeechAnnotaion=this.webpackJsonpSpeechAnnotaion||[]).push([[0],{42:function(e,t,n){},47:function(e,t,n){},65:function(e,t,n){"use strict";n.r(t);var a,o,r,i,c,s=n(0),l=n.n(s),d=n(20),u=n.n(d),h=(n(42),n(5)),b=n(8),p=n.n(b),f=n(21),m=n(22),g=n(23),j=n(37),v=n(36),x=n(24),y=n.n(x),O=n(25),w=n.n(O),S=n(26),M=n.n(S),k=n(27),C=n.n(k),F=n(28),N=n.n(F),D=n(29),L=n.n(D),P=n(3),A=n(4),E=A.a.div(a||(a=Object(P.a)(["\n  display: flex;  \n  flex-direction: row;  \n  align-items: center;\n  justify-content: center;\n  height: 100px;  width: 100%;\n  background: transparent;\n"]))),R=A.a.div(o||(o=Object(P.a)(["\n\n"]))),T=A.a.div(r||(r=Object(P.a)(["\n  width: 100%;\n  height: 90px;\n"]))),B=A.a.div(i||(i=Object(P.a)(["\n    width: 100%;\n    height: 10px\n    "]))),I=A.a.button(c||(c=Object(P.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 60px;\n  height: 60px;\n  background: #EFEFEF;\n  border-radius: 50%;\n  border: none;\n  outline: none;\n  cursor: pointer;\n  padding-bottom: 3px;\n  &:hover {\n    background: #DDD;\n  }\n"]))),J=n(33),_=(n(45),n(1)),U=function(e){Object(j.a)(n,e);var t=Object(v.a)(n);function n(){var e;Object(m.a)(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={playing:!1,zoom:0,cursorTime:0,url:e.props.url,spectogram:e.props.spectogram,table:e.props.filedata.table,index:e.props.filedata.index,serial:e.props.filedata.serial,regions:[],responseMessage:"Send to server",start:.1,end:.5,label:"",duration:0},e.handlePlayPause=function(){e.setState({playing:!e.state.playing}),e.waveform.playPause()},e.addRegion=function(){e.waveform.addRegion({start:e.state.start,end:e.state.end,data:e.state.label,color:n.randomColor()})},e.removeAll=function(){e.waveform.clearRegions()},e.downloadFile=Object(f.a)(p.a.mark((function t(){var n,a,o,r,i,c,s;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=[],Object.values(e.waveform.regions.list).map((function(e){var t={start:e.start,end:e.end,label:e.data};return n.push(t)})),a="file",o={duration:e.state.duration,url:e.state.url,regions:n},r=JSON.stringify(o),i=new Blob([r],{type:"application/json"}),t.next=8,URL.createObjectURL(i);case 8:c=t.sent,(s=document.createElement("a")).href=c,s.download=a+".json",document.body.appendChild(s),s.click(),document.body.removeChild(s);case 15:case"end":return t.stop()}}),t)}))),e.sendingFile=function(){e.setState({responseMessage:"sending..."});var t=String(e.state.table)+"/"+String(e.state.index)+"/"+e.state.serial,n=[],a=(Object.values(e.waveform.regions.list).map((function(e){var t={start:e.start,end:e.end,label:e.data};return n.push(t)})),{folder:t,duration:e.state.duration,regions:n});console.log(JSON.stringify(a));var o={method:"POST",headers:{Accept:"application/json"},body:JSON.stringify(a)};fetch("http://xn--11by0j.com:8000/api/v1/response_srt_web/",o).then((function(t){if(!t.ok)throw Error(t.statusText);return e.setState({responseMessage:"DONE"}),t.text()})).catch((function(t){e.setState({responseMessage:"ERROR"}),console.log(t)}))},e}return Object(g.a)(n,[{key:"componentDidMount",value:function(){var e=document.querySelector("#track"),t=function(e){return e>=2500?.01:e>=1e3?.025:e>=250?.1:e>=100?.25:e>=25?1:5*e>=25?5:15*e>=25?15:60*Math.ceil(.5/e)};this.waveform=y.a.create({barWidth:5,barRadius:3,barGap:3,cursorWidth:1,container:"#waveform",waveColor:"#D9DCFF",backend:"WebAudio",height:80,progressColor:"#2D5BFF",responsive:!0,hideScrollbar:!1,cursorColor:"#4353FF",plugins:[M.a.create(),w.a.create({regions:this.state.regions,dragSelection:{slop:.1,resize:!0}}),C.a.create({container:"#timeline",formatTimeCallback:function(e,t){e=Number(e);var n=Math.floor(e/60);e%=60;var a=Math.round(e).toString();return t>=250?a=e.toFixed(2):t>=25&&(a=e.toFixed(1)),n>0?(e<10&&(a="0"+a),"".concat(n,":").concat(a)):a},timeInterval:t,primaryLableInterval:function(e){return e>=2500?10:e>=1e3?4:e>=250?10:e>=100?4:e>=25?1:5*e>=25?5:15*e>=25?15:60*Math.ceil(.5/e)},secondaryLabelInterval:function(e){return Math.floor(10/t(e))},primaryColor:"blue",secondaryColor:"red",primaryFontColor:"blue",secondaryFontColor:"red"}),N.a.create({showTime:!0,opacity:1,customShowTimeStyle:{"background-color":"#000",color:"#fff",padding:"2px","font-size":"10px"}}),L.a.create({container:"#Spectograph"})]}),this.waveform.load(e);var n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5;return"\n        rgba(".concat(Math.floor(256*Math.random()),",").concat(Math.floor(256*Math.random()),",").concat(Math.floor(256*Math.random()),", ").concat(e,")\n    \n        ")};this.waveform.on("ready",(function(){this.waveform.enableDragSelection({color:n()})}))}},{key:"componentDidUpdate",value:function(){this.waveform.on("region-click",(function(e,t){t.stopPropagation(),t.shiftKey?e.playLoop():e.play()})),this.waveform.on("region-mouseenter",(function e(t){e.el||(e.el=document.querySelector("#subtitle"));e.el.textContent=t.data||"\u2013"})),this.waveform.on("region-click",(function(e){var t=document.forms.edit;t.style.opacity=1,t.elements.note.value=e.data||"",t.onsubmit=function(n){n.preventDefault(),e.update({data:t.elements.note.value}),t.style.opacity=0,document.querySelectorAll("region").forEach((function(t){if(t.getAttribute("data-id")===e.id){var n='<li class="region-label">'+e.data+"</li>";return t.insertAdjacentHTML("beforeend",n)}}))},t.onreset=function(){t.style.opacity=0,t.dataset.region=null},t.dataset.region=e.id})),this.waveform.on("region-dblclick",(function(e,t){e.remove()})),this.waveform.on("region-updated",(function(e,t){e.data}))}},{key:"render",value:function(){var e=this;return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("p",{id:"subtitle",className:"",children:"\xa0"}),Object(_.jsxs)(R,{children:[Object(_.jsx)("button",{onClick:this.removeAll,children:"Remove all"}),Object(_.jsx)("button",{onClick:this.downloadFile,children:"download"}),Object(_.jsx)("button",{onClick:this.sendingFile,children:this.state.responseMessage}),Object(_.jsx)("div",{children:"DONE"===this.state.responseMessage?Object(_.jsx)("p",{children:"Please Click 'Load Next' Button for new audio"}):null}),Object(_.jsxs)(E,{children:[Object(_.jsx)(T,{id:"waveform"}),Object(_.jsx)("audio",{id:"track",src:this.state.url,onLoadedMetadata:function(t){e.setState({duration:t.target.duration})}})]})]}),Object(_.jsxs)("div",{className:"labelForm",children:[Object(_.jsx)(I,{onClick:this.handlePlayPause,children:this.state.playing?"Pause":"Play"}),Object(_.jsxs)("form",{name:"edit",style:{opacity:0,transition:"opacity 300ms linear",margin:"10px 0"},children:[Object(_.jsxs)("div",{className:"form-group",children:[Object(_.jsx)("label",{htmlFor:"note",children:"Note"}),Object(_.jsx)(J.a,{value:this.state.label,onChange:function(t){return e.setState({label:t.target.value})},id:"note",className:"form-control",rows:"3",name:"note"})]}),Object(_.jsx)("button",{type:"submit",className:"btn btn-success btn-block",children:"Save"})]})]}),Object(_.jsx)("img",{src:this.state.spectogram,height:"300px",width:"100%",alt:"newdata"}),Object(_.jsx)(B,{id:"timeline"})]})}}]),n}(s.Component);U.randomColor=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5;return"\n    rgba(".concat(Math.floor(256*Math.random()),",").concat(Math.floor(256*Math.random()),",").concat(Math.floor(256*Math.random()),", ").concat(e,")\n\n    ")};var q=U,z=(n(47),n(35)),W=n.n(z).a.create({baseURL:"http://xn--11by0j.com:8000/api/v1/",timeout:5e3,headers:{"Content-Type":"application/json",accept:"application/json"}});var G=function(){var e=Object(s.useState)(""),t=Object(h.a)(e,2),n=t[0],a=t[1],o=Object(s.useState)(""),r=Object(h.a)(o,2),i=r[0],c=r[1],l=Object(s.useState)({}),d=Object(h.a)(l,2),u=d[0],b=d[1],p=Object(s.useState)(!0),f=Object(h.a)(p,2),m=f[0],g=f[1];return Object(s.useEffect)((function(){W.get("get_data").then((function(e){var t=e.data;a(t.sound_url),c(t.spectogram_url),b({table:t.table,index:t.index,serial:t.serial}),g(!1)}))}),[]),Object(_.jsxs)("div",{className:"App",children:[Object(_.jsx)("button",{type:"button",onClick:function(){window.location.reload()},children:"Load next"}),m?null:Object(_.jsx)(q,{url:n,spectogram:i,filedata:u})]})},H=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,66)).then((function(t){var n=t.getCLS,a=t.getFID,o=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),a(e),o(e),r(e),i(e)}))};u.a.render(Object(_.jsx)(l.a.StrictMode,{children:Object(_.jsx)(G,{})}),document.getElementById("root")),H()}},[[65,1,2]]]);
//# sourceMappingURL=main.f1944187.chunk.js.map